(this["webpackJsonpviz-react"]=this["webpackJsonpviz-react"]||[]).push([[0],{311:function(e,t,n){},312:function(e,t,n){"use strict";n.r(t);var a=n(40),c=n.n(a),o=n(39),r=n(107),i=n(93),u=n(207),l=n(139),s=n(32),j=n(190),d=n.n(j),b=n(208),O=n(331),p=n(324),f=n(329),h=n(320),m=n(315),x=Object(O.a)("loadEventsRequest"),v=Object(O.a)("loadEventsSuccess"),y=Object(O.a)("loadEventsFailure"),C=Object(O.a)("editEvent"),g=Object(O.a)("deleteEvent"),D=Object(O.a)("addEvent"),w=Object(i.c)({isFetching:Object(p.a)({[x]:function(){return!0},[Object(f.a)(v,y)]:function(){return!1}},!1),error:Object(p.a)({[x]:function(){return null},[y]:function(e,t){return t}},null),eventTypes:Object(p.a)({[v]:function(e,t){return t.payload.eventTypes}},[]),persons:Object(p.a)({[v]:function(e,t){return t.payload.persons}},[]),toponyms:Object(p.a)({[v]:function(e,t){return t.payload.toponyms}},[]),events:Object(p.a)({[v]:function(e,t){return Object(h.a)(t.payload.events.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{startDate:new Date(e.startDate),endDate:new Date(e.endDate)})})),(function(e){return e.endDate-e.startDate}),"desc")},[C]:function(e,t){return e.map((function(e){return e.id===t.payload.id?t.payload:e}))},[g]:function(e,t){return e.filter((function(e){return e.id!==t.payload.id}))},[D]:function(e,t){return[].concat(Object(l.a)(e),[Object(s.a)(Object(s.a)({},t.payload),{},{id:Object(m.a)()})])}},[])}),k=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,S=Object(i.e)(w,k(Object(i.a)(u.a))),F=n(89),I=n(0),_=n(37),E=n(318),T=n(75),N=n(330),L=n(220),M=n(323),R="/editor",A=n(49),B=n(332),K=function(e){return e.events},V=function(e){return e.toponyms},P=function(e){return e.persons},Y=function(e){return e.eventTypes},z=n(8),J=function(e){var t=e.filename,n=void 0===t?"events.json":t,a=Object(o.c)(K),c=Object(o.c)(Y),r=Object(o.c)(P),i=Object(o.c)(V),u=JSON.stringify({events:a,eventTypes:c,toponyms:i,persons:r});return Object(z.jsxs)(A.a,{download:n,href:URL.createObjectURL(new Blob([u],{type:"application/json"})),children:[Object(z.jsx)(B.a,{}),"Export to json"]})},U=n(328),H=n(316),X=n(325),q=n(319),G=function(e){return e.toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"})},Q=function(e){return e.type},W=function(e){return e.map((function(e){return"".concat(e.surname," ").concat(e.name," ").concat(e.patron)})).join()},Z=function(e){return e.map((function(e){return e.name})).join()},$=function(e,t){return e.startDate-t.startDate},ee=function(e,t){return e.endDate-t.endDate},te=function(e){var t=e.onAdd,n=e.onSelect,a=e.deleteRow,c=Object(I.useState)(""),r=Object(F.a)(c,2),i=r[0],u=r[1],l=Object(o.c)(Y),j=Object(o.c)(P),d=Object(o.c)(V),b=Object(o.c)(K),O=Object(I.useMemo)((function(){return b.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{type:l.find((function(t){return t.id===e.type})),persons:e.persons?e.persons.map((function(e){return j.find((function(t){return t.id===e}))})):[],toponyms:e.toponyms?e.toponyms.map((function(e){return d.find((function(t){return t.id===e}))})):[]})})).filter((function(e){return e.name.toLowerCase().includes(i.toLowerCase())}))}),[b,l,j,d,i]),p=Object(I.useCallback)((function(e){return{onClick:n?function(){return n(e)}:void 0}}),[n]),f=Object(I.useCallback)(Object(U.a)((function(e){return u(e)})),[]);return Object(z.jsxs)("div",{children:[Object(z.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:"10px 20px"},children:[Object(z.jsx)(A.a,{type:"primary",onClick:t,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),Object(z.jsx)(X.a.Search,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430",onSearch:f,style:{width:400}})]}),Object(z.jsxs)(q.a,{dataSource:O,rowKey:function(e){return e.id},onRow:p,children:[Object(z.jsx)(q.a.Column,{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",width:"35%"}),Object(z.jsx)(q.a.Column,{title:"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430",dataIndex:"startDate",width:"10%",sorter:$,render:G}),Object(z.jsx)(q.a.Column,{title:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f",dataIndex:"endDate",width:"10%",sorter:ee,render:G}),Object(z.jsx)(q.a.Column,{title:"\u0422\u0438\u043f",dataIndex:"type",width:"10%",filters:l.map((function(e){return{value:e.id,text:e.type}})),onFilter:function(e,t){return t.type.id===e},render:Q}),Object(z.jsx)(q.a.Column,{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043b\u0438\u0446\u0430",dataIndex:"persons",width:"15%",render:W}),Object(z.jsx)(q.a.Column,{title:"\u0422\u043e\u043f\u043e\u043d\u0438\u043c\u044b",dataIndex:"toponyms",width:"15%",render:Z}),Object(z.jsx)(q.a.Column,{title:"",render:function(e,t){return Object(z.jsx)(H.a,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onConfirm:function(e){e.stopPropagation(),a(t)},onCancel:function(e){e.stopPropagation()},okText:"\u0414\u0430",cancelText:"\u041d\u0435\u0442",children:Object(z.jsx)(A.a,{type:"link",onClick:function(e){e.stopPropagation()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})}},"delete")]})]})},ne=n(172),ae=n(327),ce=n(213),oe=n(322),re=n(68),ie=n.n(re),ue=n(101),le=n(150),se=n(321),je=function(e){var t=e.dateFormat,n=void 0===t?"DD.MM.YYYY":t,a=Object(ue.a)(e,["dateFormat"]);return Object(z.jsx)(se.a,Object(s.a)({format:n},a))},de=n(138),be=function(e){return e.id},Oe=function(e){return e.name},pe=[],fe=function(e){var t=e.options,n=void 0===t?pe:t,a=e.optionKeyFactory,c=void 0===a?be:a,o=e.optionValueFactory,r=void 0===o?be:o,i=e.optionNameFactory,u=void 0===i?Oe:i,l=Object(ue.a)(e,["options","optionKeyFactory","optionValueFactory","optionNameFactory"]);return Object(z.jsx)(de.a,Object(s.a)(Object(s.a)({},l),{},{children:n.map((function(e){return Object(z.jsx)(de.a.Option,{value:r(e),children:u(e)},c(e))}))}))},he=n(326),me=[],xe=function(e){var t=e.allOptions,n=e.value,a=void 0===n?me:n,c=e.onChange,o=e.placeholder,r=e.count,i=void 0===r?5:r,u=e.optionKeyFactory,s=void 0===u?be:u,j=e.optionValueFactory,d=void 0===j?be:j,b=e.optionNameFactory,O=void 0===b?Oe:b,p=Object(I.useState)([]),f=Object(F.a)(p,2),h=f[0],m=f[1],x=Object(I.useCallback)(Object(U.a)((function(e){m(t.filter((function(t){return O(t).toLowerCase().includes(e.toLocaleLowerCase())})))}),300),[t]),v=Object(I.useCallback)((function(){m([])}),[]),y=Object(I.useCallback)((function(e){m([]),c(e)}),[c]),C=Object(I.useMemo)((function(){return a.map((function(e){return t.find((function(t){return d(t)===e}))}))}),[t,a,d]),g=Object(I.useMemo)((function(){return h.length?h.slice(0,i):Object(he.a)([].concat(Object(l.a)(t.slice(0,i)),Object(l.a)(C)))}),[t,i,h,C]),D=Object(I.useMemo)((function(){return h.length?h.length-i:t.length-g.length}),[t,i,h,g.length]);return Object(z.jsxs)(de.a,{placeholder:o,mode:"multiple",filterOption:!1,onSearch:x,onChange:y,onBlur:v,value:a,children:[g.map((function(e){return Object(z.jsx)(de.a.Option,{value:d(e),children:O(e)},s(e))})),D>0&&Object(z.jsxs)(de.a.Option,{value:"__hidedOptionsCount__",disabled:!0,children:["\u0415\u0449\u0435 ",D," \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"]},"__hidedOptionsCount__")]})},ve=function(e){return function(t){var n=t.name,a=t.label,c=t.validate,o=t.allowNull,r=void 0===o||o,i=t.format,u=void 0===i?le.a:i,l=t.parse,j=void 0===l?le.a:l,d=Object(ue.a)(t,["name","label","validate","allowNull","format","parse"]);return Object(z.jsx)(ne.a,{name:n,format:u,parse:j,allowNull:r,validate:c,children:function(t){var n=t.input,c=n.value,o=n.onChange,r=n.onBlur,i=n.onFocus,u=t.meta,l=u.invalid,j=u.touched,b=u.error;return Object(z.jsx)(oe.a.Item,{label:a,validateStatus:j&&l?"error":"success",help:j&&l?b:void 0,children:Object(z.jsx)(e,Object(s.a)({value:c,onChange:o,onBlur:r,onFocus:i},d))})}})}},ye=function(e){return function(t){var n=t.debounceTimeout,a=void 0===n?300:n,c=t.onChange,o=t.value,r=Object(ue.a)(t,["debounceTimeout","onChange","value"]),i=Object(I.useState)(o),u=Object(F.a)(i,2),l=u[0],j=u[1],d=Object(I.useCallback)(Object(U.a)((function(e){c(e)}),a),[]),b=Object(I.useCallback)((function(e){var t=e.target.value;j(t),d(t)}),[d]);return Object(z.jsx)(e,Object(s.a)({value:l,onChange:b},r))}},Ce=(ve(ye(X.a)),ve(ye(X.a.TextArea))),ge=ve(je),De=ve(fe),we=ve(xe),ke=n(317),Se=n(36),Fe=function(e){return Object(ke.a)(e)||""===e||Object(Se.a)(e)&&0===e.length?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e":void 0},Ie=function(e,t){return function(n,a){return n.isBefore(a[e],"day")?"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 \u0447\u0435\u043c ".concat(t):void 0}},_e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,a){return t.reduce((function(t,c){return t||c(e,n,a)}),void 0)}},Ee=function(e){return e.type},Te=function(e){return"".concat(e.surname," ").concat(e.name," ").concat(e.patron)},Ne={name:null,startDate:null,endDate:null,type:null,toponyms:[],persons:[]},Le=function(e){var t=e.onSubmit,n=e.onClose,a=e.title,c=Object(o.c)(Y),r=Object(o.c)(V),i=Object(o.c)(P),u=Object(o.c)(K),l=Object(_.j)().id;if(u.length<1)return Object(z.jsx)(ae.a,{title:a,onClose:n,placement:"right",width:450,visible:!0,closable:!0,destroyOnClose:!0,children:Object(z.jsx)("div",{style:{minHeight:200,display:"flex",alignItems:"center",justifyContent:"center"},children:Object(z.jsx)(ce.a,{size:"large"})})});var j=u.find((function(e){return e.id===Number(l)})),d=j?function(e){return Object(s.a)(Object(s.a)({},e),{},{startDate:ie()(e.startDate),endDate:ie()(e.endDate)})}(j):Ne;return Object(z.jsx)(ae.a,{title:a,onClose:n,placement:"right",width:450,visible:!0,closable:!0,destroyOnClose:!0,children:Object(z.jsx)(ne.b,{initialValues:d,onSubmit:function(e){t(e)},children:function(e){var t,n,a=e.handleSubmit;return Object(z.jsxs)(oe.a,{layout:"vertical",onFinish:a,children:[Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(Ce,{name:"name",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",rows:4,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",validate:Fe})}),Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(ge,{name:"startDate",label:"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430",validate:_e(Fe,(t="endDate",n="\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f",function(e,a){return e.isAfter(a[t],"day")?"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 \u0447\u0435\u043c ".concat(n):void 0}))})}),Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(ge,{name:"endDate",label:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f",validate:_e(Fe,Ie("startDate","\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430"))})}),Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(De,{name:"type",label:"\u0422\u0438\u043f",options:c,optionNameFactory:Ee,validate:Fe})}),Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(we,{name:"toponyms",label:"\u0422\u043e\u043f\u043e\u043d\u0438\u043c\u044b",allOptions:r,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u043f\u043e\u043d\u0438\u043c\u044b"})}),Object(z.jsx)(oe.a.Item,{children:Object(z.jsx)(we,{name:"persons",label:"\u0414\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043b\u0438\u0446\u0430",allOptions:i,optionNameFactory:Te,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043b\u0438\u0446"})}),Object(z.jsx)("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"},children:Object(z.jsx)(A.a,{htmlType:"submit",type:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})]})}})})},Me="".concat(R,"/add"),Re="".concat(R,"/edit/:id"),Ae=function(){var e=Object(o.b)(),t=Object(_.h)(),n=Object(I.useCallback)((function(e){t.push(Object(_.f)(Re,{id:e.id}))}),[t]),a=Object(I.useCallback)((function(){t.push(R)}),[t]),c=Object(I.useCallback)((function(t){e(C(Object(s.a)(Object(s.a)({},t),{},{endDate:t.endDate.toDate(),startDate:t.startDate.toDate()}))),a(),L.b.success("\u0421\u043e\u0431\u044b\u0442\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043e")}),[e,a]),r=Object(I.useCallback)((function(t){e(g(t))}),[e]),i=Object(I.useCallback)((function(t){e(D(Object(s.a)(Object(s.a)({},t),{},{id:Object(m.a)(),endDate:t.endDate.toDate(),startDate:t.startDate.toDate()}))),a(),L.b.success("\u0421\u043e\u0431\u044b\u0442\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e")}),[a,e]),u=Object(I.useCallback)((function(){t.push(Me)}),[t]);return Object(z.jsxs)(E.a,{children:[Object(z.jsx)(M.a,{ghost:!1,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445",extra:Object(z.jsx)(J,{})}),Object(z.jsxs)(E.a.Content,{children:[Object(z.jsx)(te,{onAdd:u,onSelect:n,deleteRow:r}),Object(z.jsx)(_.b,{path:Me,render:function(){return Object(z.jsx)(Le,{onClose:a,onSubmit:i,title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})}}),Object(z.jsx)(_.b,{path:Re,render:function(){return Object(z.jsx)(Le,{onClose:a,onSubmit:c,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})}})]})]})},Be=[R],Ke=function(){var e=Object(I.useState)(!0),t=Object(F.a)(e,2),a=t[0],c=t[1],i=Object(o.b)(),u=Object(_.i)().pathname,l=Object(I.useMemo)((function(){return[Be.find((function(e){return e===u}))]}),[u]);return Object(I.useEffect)((function(){i(function(){var e=Object(b.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(x()),e.prev=1,e.next=4,n.e(3).then(n.t.bind(null,333,3));case 4:a=e.sent,t(v(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t(y(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())}),[i]),Object(z.jsxs)(E.a,{style:{minHeight:"100vh"},hasSider:!0,children:[Object(z.jsx)(E.a.Sider,{theme:"dark",collapsible:!0,width:240,collapsed:a,onCollapse:c,style:{overflow:"auto",height:"100vh",position:"fixed",left:0},children:Object(z.jsx)(T.a,{theme:"dark",mode:"inline",selectedKeys:l,children:Object(z.jsx)(T.a.Item,{children:Object(z.jsxs)(r.b,{to:R,children:[Object(z.jsx)(N.a,{}),Object(z.jsx)("span",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445"})]})},R)})}),Object(z.jsx)(E.a,{style:{marginLeft:a?80:240,transition:"margin 0.2s"},children:Object(z.jsx)(E.a.Content,{children:Object(z.jsxs)(_.d,{children:[Object(z.jsx)(_.b,{path:R,component:Ae}),Object(z.jsx)(_.a,{to:R})]})})})]})};n(311);c.a.render(Object(z.jsx)(r.a,{children:Object(z.jsx)(o.a,{store:S,children:Object(z.jsx)(Ke,{})})}),document.getElementById("root"))}},[[312,1,2]]]);
//# sourceMappingURL=main.5c0d1bbf.chunk.js.map