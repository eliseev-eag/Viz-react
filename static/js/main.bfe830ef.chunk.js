(this["webpackJsonpviz-react"]=this["webpackJsonpviz-react"]||[]).push([[0],{286:function(e,t,n){e.exports=n(508)},507:function(e,t,n){},508:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),o=n.n(c),l=n(6),i=n.n(l),u=n(22),s=n(128),p=n(68),b=n(267),m=n(130),d=n(28),f=n(210),O=n.n(f),j=n(268),y=n(528),E=n(519),v=n(526),h=n(515),g=n(511);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=Object(y.a)("loadEventsRequest"),k=Object(y.a)("loadEventsSuccess"),P=Object(y.a)("loadEventsFailure"),S=Object(y.a)("changeTimelineRange"),x=Object(y.a)("editEvent"),I=Object(y.a)("deleteEvent"),_=Object(y.a)("addEvent"),M={start:new Date(100,0,0),end:new Date},T=Object(p.c)({requestWorking:Object(E.a)((a={},Object(d.a)(a,C,(function(){return!0})),Object(d.a)(a,Object(v.a)(k,P),(function(){return!1})),a),!1),eventTypes:Object(E.a)(Object(d.a)({},k,(function(e,t){return t.payload.eventTypes})),[]),persons:Object(E.a)(Object(d.a)({},k,(function(e,t){return t.payload.persons})),[]),toponyms:Object(E.a)(Object(d.a)({},k,(function(e,t){return t.payload.toponyms})),[]),events:Object(E.a)((r={},Object(d.a)(r,k,(function(e,t){return Object(h.a)(t.payload.events.map((function(e){return w({},e,{startDate:new Date(e.startDate),endDate:new Date(e.endDate)})})),(function(e){return e.endDate-e.startDate}),"desc")})),Object(d.a)(r,x,(function(e,t){return e.map((function(e){return e.id===t.payload.id?t.payload:e}))})),Object(d.a)(r,I,(function(e,t){return e.filter((function(e){return e.id!==t.payload.id}))})),Object(d.a)(r,_,(function(e,t){return[].concat(Object(m.a)(e),[w({},t.payload,{id:Object(g.a)()})])})),r),[]),errorOccured:Object(E.a)(Object(d.a)({},P,(function(){return!0})),!1),timeline:Object(E.a)(Object(d.a)({},S,(function(e,t){var n=t.payload;return{start:n.start,end:n.end}})),M)}),L=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d,R=Object(p.e)(T,L(Object(p.a)(b.a))),Y=n(59),q=n(73),F=n(512),A=n(115),H=n(9),z=n(523),B=n(518),J=n(270),N=n.n(J),U=function(e){return e.events},K=function(e){return e.toponyms},V=function(e){return e.persons},X=function(e){return e.eventTypes},W={align:"center",minHeight:"400px",maxHeight:"400px",type:"range",tooltip:{followMouse:!0,overflowMethod:"cap"},snap:null,orientation:{axis:"both"},zoomMin:432e6},G=Object(B.a)(X,(function(e){return e.map((function(e){return{id:e.id,content:e.type}}))})),Q=Object(B.a)(U,(function(e){return e.slice(0,10).map((function(e){return{start:e.startDate,end:e.endDate,content:e.name,duration:e.endDate-e.startDate,group:e.type,type:e.endDate-e.startDate<=864e5?"point":"range"}}))})),Z=function(){var e=Object(u.b)(),t=Object(u.c)(Q),n=Object(u.c)(G),a=Object(c.useCallback)((function(t){var n=t.start,a=t.end;e(S({start:n,end:a}))}),[e]);return o.a.createElement("div",null,t&&t.length>0&&o.a.createElement(N.a,{options:W,items:t,groups:n,rangechangedHandler:a}))},$=function(){return o.a.createElement(F.a,null,o.a.createElement(z.a,{ghost:!1,title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u0430\u043d\u043d\u044b\u0445"}),o.a.createElement(F.a.Content,null,o.a.createElement(Z,null)))},ee=n(13),te=n.n(ee),ne=n(56),ae=function(e){var t=e.filename,n=void 0===t?"events.json":t,a=Object(u.c)(U),r=Object(u.c)(X),c=Object(u.c)(V),l=Object(u.c)(K),i=JSON.stringify({events:a,eventTypes:r,toponyms:l,persons:c});return o.a.createElement(ne.a,{download:n,href:URL.createObjectURL(new Blob([i],{type:"application/json"}))},o.a.createElement(H.a,{type:"download"}),"Export to json")},re=n(527),ce=n(513),oe=n(522),le=n(516);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var ue=function(e){return e.toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"})},se=function(e){return e.type},pe=function(e){return e.map((function(e){return"".concat(e.surname," ").concat(e.name," ").concat(e.patron)})).join()},be=function(e){return e.map((function(e){return e.name})).join()},me=function(e,t){return e.startDate-t.startDate},de=function(e,t){return e.endDate-t.endDate},fe=function(e){var t=e.onAdd,n=e.onSelect,a=e.deleteRow,r=Object(c.useState)(""),l=Object(Y.a)(r,2),i=l[0],s=l[1],p=Object(u.c)(X),b=Object(u.c)(V),m=Object(u.c)(K),f=Object(u.c)(U),O=Object(c.useMemo)((function(){return f.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{type:p.find((function(t){return t.id===e.type})),persons:e.persons?e.persons.map((function(e){return b.find((function(t){return t.id===e}))})):[],toponyms:e.toponyms?e.toponyms.map((function(e){return m.find((function(t){return t.id===e}))})):[]})})).filter((function(e){return e.name.toLowerCase().includes(i.toLowerCase())}))}),[f,p,b,m,i]),j=Object(c.useCallback)((function(e){return{onClick:n?function(){return n(e)}:void 0}}),[n]),y=Object(c.useCallback)(Object(re.a)((function(e){return s(e)})),[]);return o.a.createElement("div",null,o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:"10px 20px"}},o.a.createElement(ne.a,{type:"primary",onClick:t},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),o.a.createElement(oe.a.Search,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430",onSearch:y,style:{width:400}})),o.a.createElement(le.a,{dataSource:O,rowKey:function(e){return e.id},onRow:j},o.a.createElement(le.a.Column,{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",dataIndex:"name",width:"35%"}),o.a.createElement(le.a.Column,{title:"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430",dataIndex:"startDate",width:"10%",sorter:me,render:ue}),o.a.createElement(le.a.Column,{title:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f",dataIndex:"endDate",width:"10%",sorter:de,render:ue}),o.a.createElement(le.a.Column,{title:"\u0422\u0438\u043f",dataIndex:"type",width:"10%",filters:p.map((function(e){return{value:e.id,text:e.type}})),onFilter:function(e,t){return t.type.id===e},render:se}),o.a.createElement(le.a.Column,{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043b\u0438\u0446\u0430",dataIndex:"persons",width:"15%",render:pe}),o.a.createElement(le.a.Column,{title:"\u0422\u043e\u043f\u043e\u043d\u0438\u043c\u044b",dataIndex:"toponyms",width:"15%",render:be}),o.a.createElement(le.a.Column,{title:"",key:"delete",render:function(e,t){return o.a.createElement(ce.a,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onConfirm:function(e){e.stopPropagation(),a(t)},onCancel:function(e){e.stopPropagation()},okText:"\u0414\u0430",cancelText:"\u041d\u0435\u0442"},o.a.createElement(ne.a,{type:"link",onClick:function(e){e.stopPropagation()}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}})))},Oe=n(524),je=n(525),ye=n(520),Ee=n(514),ve=n(517),he=n(129),ge=n(521),De=function(e){return e.id},we=function(e){return e.name},Ce=[],ke=Object(c.forwardRef)((function(e,t){var n=e.allOptions,a=e.value,r=void 0===a?Ce:a,l=e.onChange,i=e.placeholder,u=e.count,s=void 0===u?5:u,p=e.keySelector,b=void 0===p?De:p,d=e.valueSelector,f=void 0===d?De:d,O=e.nameSelector,j=void 0===O?we:O,y=Object(c.useState)([]),E=Object(Y.a)(y,2),v=E[0],h=E[1],g=Object(c.useCallback)(Object(re.a)((function(e){h(n.filter((function(t){return j(t).toLowerCase().includes(e.toLocaleLowerCase())})))}),300),[n]),D=Object(c.useCallback)((function(){h([])}),[]),w=Object(c.useCallback)((function(e){h([]),l(e)}),[l]),C=Object(c.useMemo)((function(){return r.map((function(e){return n.find((function(t){return f(t)===e}))}))}),[n,r,f]),k=Object(c.useMemo)((function(){return v.length?v.slice(0,s):Object(ge.a)([].concat(Object(m.a)(n.slice(0,s)),Object(m.a)(C)))}),[n,s,v,C]),P=Object(c.useMemo)((function(){return v.length?v.length-s:n.length-k.length}),[n,s,v,k.length]);return o.a.createElement(he.a,{ref:t,placeholder:i,mode:"multiple",filterOption:!1,onSearch:g,onChange:w,onBlur:D,value:r},k.map((function(e){return o.a.createElement(he.a.Option,{key:b(e),value:f(e)},j(e))})),P>0&&o.a.createElement(he.a.Option,{key:"__hidedOptionsCount__",value:"__hidedOptionsCount__",disabled:!0},"\u0415\u0449\u0435 ",P," \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"))}));function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Se={name:{rules:[{required:!0}]},startDate:{rules:[{type:"object",required:!0,message:"Please select time!"}]},endDate:{rules:[{type:"object",required:!0,message:"Please select time!"}]},type:{rules:[{required:!0}]},persons:{rules:[{type:"array"}]},toponyms:{rules:[{type:"array"}]}},xe=ye.a.create()((function(e){var t=e.event,n=e.onSubmit,a=e.form,r=a.getFieldDecorator,l=a.setFieldsValue,i=a.validateFields,s=e.visible,p=e.onClose,b=e.title,m=Object(u.c)(X),f=Object(u.c)(K),O=Object(u.c)(V);return Object(c.useEffect)((function(){t&&l(Object(Oe.a)(t,Object.keys(Se)))}),[t,l]),o.a.createElement(je.a,{title:b,visible:s,onClose:p,placement:"right",width:450,closable:!0,destroyOnClose:!0},o.a.createElement(ye.a,{layout:"vertical"},o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"},r("name",Se.name)(o.a.createElement(oe.a.TextArea,{rows:4,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"})))),o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430"},r("startDate",Se.startDate)(o.a.createElement(ve.a,{format:"DD.MM.YYYY"})))),o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f"},r("endDate",Se.endDate)(o.a.createElement(ve.a,{format:"DD.MM.YYYY"})))),o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u0422\u0438\u043f"},r("type",Se.type)(o.a.createElement(he.a,{placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f \u0441\u043e\u0431\u044b\u0442\u0438\u044f"},m.map((function(e){return o.a.createElement(he.a.Option,{key:e.id,value:e.id},e.type)})))))),o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u0422\u043e\u043f\u043e\u043d\u0438\u043c\u044b"},r("toponyms",Se.toponyms)(o.a.createElement(ke,{allOptions:f,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u043f\u043e\u043d\u0438\u043c\u044b"})))),o.a.createElement(Ee.a,null,o.a.createElement(ye.a.Item,{label:"\u0414\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043b\u0438\u0446\u0430"},r("persons",Se.persons)(o.a.createElement(ke,{allOptions:O,nameSelector:function(e){return"".concat(e.surname," ").concat(e.name," ").concat(e.patron)},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043b\u0438\u0446"})))),o.a.createElement("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},o.a.createElement(ne.a,{onClick:function(e){e.preventDefault(),i((function(e,a){e||n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:t?t.id:null},a))}))},type:"primary"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))}));function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me=function(){var e=Object(u.b)(),t=Object(c.useState)(!1),n=Object(Y.a)(t,2),a=n[0],r=n[1],l=Object(c.useState)(null),i=Object(Y.a)(l,2),s=i[0],p=i[1],b=Object(c.useCallback)((function(e){return p(_e({},e,{startDate:te()(e.startDate),endDate:te()(e.endDate),type:e.type.id,toponyms:e.toponyms.map((function(e){return e.id})),persons:e.persons.map((function(e){return e.id}))}))}),[]),m=Object(c.useCallback)((function(){a?r(!1):p(null)}),[a]),d=Object(c.useCallback)((function(t){e(x(_e({},t,{endDate:t.endDate.toDate(),startDate:t.startDate.toDate()}))),m()}),[e,m]),f=Object(c.useCallback)((function(t){e(I(t))}),[e]),O=Object(c.useCallback)((function(t){e(_(_e({},t,{endDate:t.endDate.toDate(),startDate:t.startDate.toDate()}))),m()}),[m,e]),j=Object(c.useCallback)((function(){r(!0)}),[]);return o.a.createElement(F.a,null,o.a.createElement(z.a,{ghost:!1,title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445",extra:o.a.createElement(ae,null)}),o.a.createElement(F.a.Content,null,o.a.createElement(fe,{onAdd:j,onSelect:b,deleteRow:f}),o.a.createElement(xe,{event:s,visible:null!==s||a,onClose:m,onSubmit:a?O:d,title:a?"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})))},Te=["/view","/editor"],Le=function(){var e=Object(c.useState)(!0),t=Object(Y.a)(e,2),a=t[0],r=t[1],l=Object(u.b)(),i=Object(q.g)().pathname,p=Object(c.useMemo)((function(){return[Te.find((function(e){return e===i}))]}),[i]);return Object(c.useEffect)((function(){l(function(){var e=Object(j.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(C()),e.prev=1,e.next=4,n.e(3).then(n.t.bind(null,529,3));case 4:a=e.sent,t(k(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t(P(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())}),[l]),o.a.createElement(F.a,{style:{minHeight:"100vh"},hasSider:!0},o.a.createElement(F.a.Sider,{theme:"dark",collapsible:!0,width:240,collapsed:a,onCollapse:r,style:{overflow:"auto",height:"100vh",position:"fixed",left:0}},o.a.createElement(A.a,{theme:"dark",mode:"inline",selectedKeys:p},o.a.createElement(A.a.Item,{key:"/view"},o.a.createElement(s.b,{to:"/view"},o.a.createElement(H.a,{type:"pie-chart"}),o.a.createElement("span",null,"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u0430\u043d\u043d\u044b\u0445"))),o.a.createElement(A.a.Item,{key:"/editor"},o.a.createElement(s.b,{to:"/editor"},o.a.createElement(H.a,{type:"edit"}),o.a.createElement("span",null,"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445"))))),o.a.createElement(F.a,{style:{marginLeft:a?80:240,transition:"margin 0.2s"}},o.a.createElement(F.a.Content,null,o.a.createElement(q.d,null,o.a.createElement(q.b,{path:"/view",component:$}),o.a.createElement(q.b,{path:"/editor",component:Me}),o.a.createElement(q.a,{to:"/view"})))))};n(507);i.a.render(o.a.createElement(s.a,null,o.a.createElement(u.a,{store:R},o.a.createElement(Le,null))),document.getElementById("root"))}},[[286,1,2]]]);
//# sourceMappingURL=main.bfe830ef.chunk.js.map