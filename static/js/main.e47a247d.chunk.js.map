{"version":3,"sources":["ducks.js","store.js","selectors.js","App/DataViewPage/EventsTimeline.js","App/DataViewPage/DataViewPage.js","App/DataEditorPage/DownloadButton.js","App/DataEditorPage/EditorTable.js","components/DateBox.js","components/constants.js","components/SelectBox.js","components/LazySelectSearch.js","components/WrappedComponents.js","App/DataEditorPage/validators.js","App/DataEditorPage/EventForm.js","App/DataEditorPage/routes.js","App/routes.js","App/DataEditorPage/DataEditorPage.js","App/App.js","index.js"],"names":["loadEventsRequest","createAction","loadEventsSuccess","loadEventsFailure","editEvent","deleteEvent","addEvent","combineReducers","isFetching","handleActions","combineActions","error","state","data","eventTypes","payload","persons","toponyms","events","orderBy","map","event","startDate","Date","endDate","id","filter","uniqueId","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","thunk","eventsSelector","toponymsSelector","personsSelector","eventTypesSelector","isFetchingSelector","errorSelector","TIMELINE_OPTIONS","align","minHeight","maxHeight","type","tooltip","followMouse","overflowMethod","snap","orientation","axis","zoomMin","MILLISECONDS_IN_DAY","EventsTimeline","useSelector","items","useMemo","slice","start","end","content","name","duration","group","groups","eventType","length","options","DataViewPage","isFethcing","ghost","title","Content","style","display","alignItems","justifyContent","size","message","description","showIcon","DownloadButton","filename","JSON","stringify","download","href","URL","createObjectURL","Blob","dateFormatter","date","toLocaleString","year","month","day","typeFormatter","personsFormatter","person","surname","patron","join","toponymsFormatter","toponym","startDateSorter","a","b","endDateSorter","EditorTable","onAdd","onSelect","deleteRow","useState","setFilter","eventsWithNestedData","find","personId","toponymId","it","toLowerCase","includes","onRow","useCallback","record","onClick","undefined","onSearch","debounce","value","flexDirection","padding","Search","placeholder","width","dataSource","rowKey","Column","dataIndex","sorter","render","filters","text","onFilter","key","_","onConfirm","stopPropagation","onCancel","okText","cancelText","DateBox","dateFormat","otherProps","format","ID_FACTORY","NAME_FACTORY","OPTIONS_DEFAULT_VALUE","SelectBox","optionKeyFactory","optionValueFactory","optionNameFactory","option","Option","DEFAULT_VALUE","LazySelectSearch","allOptions","onChange","count","filteredOptions","setFilteredOptions","inputValue","toLocaleLowerCase","onBlur","onChangeHandler","newValue","mappedValues","v","p","uniq","hidedOptionsCount","mode","filterOption","disabled","wrapIntoField","Component","label","validate","allowNull","identity","parse","input","meta","invalid","touched","Item","validateStatus","help","wrapIntoDebouncedInput","debounceTimeout","onChangeFormProps","viewValue","setViewValue","onChangeDebounced","updatedValue","target","WrappedTextArea","Input","TextArea","WrappedDateBox","WrappedSelectBox","WrappedLazySelectSearch","required","isNil","isArray","dateMoreThanOrEqual","fieldName","fieldLabel","allValues","isBefore","composeValidators","validators","reduce","validator","typeNameFactory","patronNameFactory","convertEventToFormFormat","moment","INITIAL_EVENT_VALUE","EventForm","onSubmit","onClose","eventId","useParams","Number","initialValues","placement","visible","closable","destroyOnClose","values","handleSubmit","layout","rows","isAfter","position","right","bottom","borderTop","background","textAlign","htmlType","addRoute","editRoute","DataEditorPage","dispatch","useDispatch","history","useHistory","push","generatePath","closeForm","changeEvent","toDate","onDelete","createEvent","showAddForm","extra","path","ROUTES","App","collapsed","setCollapsed","pathname","useLocation","selectedMenuKeys","route","useEffect","eventsData","hasSider","Sider","theme","collapsible","onCollapse","overflow","height","left","selectedKeys","to","marginLeft","transition","component","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.e47a247d.chunk.js","sourcesContent":["import { combineReducers } from 'redux';\nimport { combineActions, createAction, handleActions } from 'redux-actions';\nimport { orderBy, uniqueId } from 'lodash-es';\n\nconst loadEventsRequest = createAction('loadEventsRequest');\nconst loadEventsSuccess = createAction('loadEventsSuccess');\nconst loadEventsFailure = createAction('loadEventsFailure');\n\nexport const loadEvents = () => async dispatch => {\n  dispatch(loadEventsRequest());\n  try {\n    const eventsData = await import('./events.json');\n    dispatch(loadEventsSuccess(eventsData));\n  } catch (error) {\n    dispatch(loadEventsFailure(error));\n  }\n};\n\nexport const editEvent = createAction('editEvent');\nexport const deleteEvent = createAction('deleteEvent');\nexport const addEvent = createAction('addEvent');\n\nexport default combineReducers({\n  isFetching: handleActions(\n    {\n      [loadEventsRequest]: () => true,\n      [combineActions(loadEventsSuccess, loadEventsFailure)]: () => false,\n    },\n    false,\n  ),\n  error: handleActions(\n    {\n      [loadEventsRequest]: () => null,\n      [loadEventsFailure]: (state, data) => data,\n    },\n    null,\n  ),\n  eventTypes: handleActions(\n    {\n      [loadEventsSuccess]: (state, data) => data.payload.eventTypes,\n    },\n    [],\n  ),\n  persons: handleActions(\n    {\n      [loadEventsSuccess]: (state, data) => data.payload.persons,\n    },\n    [],\n  ),\n  toponyms: handleActions(\n    {\n      [loadEventsSuccess]: (state, data) => data.payload.toponyms,\n    },\n    [],\n  ),\n  events: handleActions(\n    {\n      [loadEventsSuccess]: (state, data) =>\n        orderBy(\n          data.payload.events.map(event => ({\n            ...event,\n            startDate: new Date(event.startDate),\n            endDate: new Date(event.endDate),\n          })),\n          event => event.endDate - event.startDate,\n          'desc',\n        ),\n      [editEvent]: (state, data) =>\n        state.map(event =>\n          event.id === data.payload.id ? data.payload : event,\n        ),\n      [deleteEvent]: (state, data) =>\n        state.filter(event => event.id !== data.payload.id),\n      [addEvent]: (state, data) => [\n        ...state,\n        { ...data.payload, id: uniqueId() },\n      ],\n    },\n    [],\n  ),\n});\n","import { applyMiddleware, compose, createStore } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from './ducks';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(\n  rootReducer,\n  composeEnhancers(applyMiddleware(thunk)),\n);\n\nexport default store;\n","export const eventsSelector = state => state.events;\nexport const toponymsSelector = state => state.toponyms;\nexport const personsSelector = state => state.persons;\nexport const eventTypesSelector = state => state.eventTypes;\nexport const isFetchingSelector = state => state.isFetching;\nexport const errorSelector = state => state.error;\n","import React, { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport Timeline from 'react-visjs-timeline';\nimport { eventsSelector, eventTypesSelector } from 'selectors';\n\nconst MILLISECONDS_IN_DAY = 1000 * 60 * 60 * 24;\n\nconst TIMELINE_OPTIONS = {\n  align: 'center',\n  minHeight: '400px',\n  maxHeight: '400px',\n  type: 'range',\n  tooltip: {\n    followMouse: true,\n    overflowMethod: 'cap',\n  },\n  snap: null,\n  orientation: { axis: 'both' },\n  zoomMin: MILLISECONDS_IN_DAY * 5,\n};\n\nconst EventsTimeline = () => {\n  const events = useSelector(eventsSelector);\n  const eventTypes = useSelector(eventTypesSelector);\n\n  const items = useMemo(\n    () =>\n      events.slice(0, 10).map(event => ({\n        start: event.startDate,\n        end: event.endDate,\n        content: event.name,\n        duration: event.endDate - event.startDate,\n        group: event.type,\n        type:\n          event.endDate - event.startDate <= MILLISECONDS_IN_DAY\n            ? 'point'\n            : 'range',\n      })),\n    [events],\n  );\n\n  const groups = useMemo(\n    () =>\n      eventTypes.map(eventType => ({\n        id: eventType.id,\n        content: eventType.type,\n      })),\n    [eventTypes],\n  );\n\n  return (\n    <div>\n      {items && items.length > 0 && (\n        <Timeline options={TIMELINE_OPTIONS} items={items} groups={groups} />\n      )}\n    </div>\n  );\n};\n\nexport default EventsTimeline;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Alert, Layout, PageHeader, Spin } from 'antd';\nimport { errorSelector, isFetchingSelector } from 'selectors';\nimport EventsTimeline from './EventsTimeline';\n\nconst DataViewPage = () => {\n  const isFethcing = useSelector(isFetchingSelector);\n  const error = useSelector(errorSelector);\n\n  return (\n    <Layout>\n      <PageHeader ghost={false} title=\"Просмотр данных\" />\n      <Layout.Content>\n        {isFethcing && (\n          <div\n            style={{\n              minHeight: 200,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Spin size=\"large\" />\n          </div>\n        )}\n        {error && (\n          <Alert\n            message=\"Произошла ошибка\"\n            description={error}\n            type=\"error\"\n            showIcon\n          />\n        )}\n        {!isFethcing && !error && <EventsTimeline />}\n      </Layout.Content>\n    </Layout>\n  );\n};\n\nexport default DataViewPage;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Button, Icon } from 'antd';\nimport {\n  eventsSelector,\n  eventTypesSelector,\n  personsSelector,\n  toponymsSelector,\n} from 'selectors';\n\nconst DownloadButton = ({ filename = 'events.json' }) => {\n  const events = useSelector(eventsSelector);\n  const eventTypes = useSelector(eventTypesSelector);\n  const persons = useSelector(personsSelector);\n  const toponyms = useSelector(toponymsSelector);\n\n  const content = JSON.stringify({\n    events,\n    eventTypes,\n    toponyms,\n    persons,\n  });\n\n  return (\n    <Button\n      download={filename}\n      href={URL.createObjectURL(\n        new Blob([content], { type: 'application/json' }),\n      )}\n    >\n      <Icon type=\"download\" />\n      Export to json\n    </Button>\n  );\n};\n\nexport default DownloadButton;\n","import React, { useCallback, useMemo, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { debounce } from 'lodash-es';\nimport { Button, Input, Popconfirm, Table } from 'antd';\nimport {\n  eventsSelector,\n  eventTypesSelector,\n  personsSelector,\n  toponymsSelector,\n} from 'selectors';\n\nconst dateFormatter = date =>\n  date.toLocaleString('ru', {\n    year: 'numeric',\n    month: 'numeric',\n    day: 'numeric',\n  });\nconst typeFormatter = type => type.type;\nconst personsFormatter = persons =>\n  persons\n    .map(person => `${person.surname} ${person.name} ${person.patron}`)\n    .join();\nconst toponymsFormatter = toponyms =>\n  toponyms.map(toponym => toponym.name).join();\n\nconst startDateSorter = (a, b) => a.startDate - b.startDate;\n\nconst endDateSorter = (a, b) => a.endDate - b.endDate;\n\nconst EditorTable = ({ onAdd, onSelect, deleteRow }) => {\n  const [filter, setFilter] = useState('');\n  const eventTypes = useSelector(eventTypesSelector);\n  const persons = useSelector(personsSelector);\n  const toponyms = useSelector(toponymsSelector);\n  const events = useSelector(eventsSelector);\n\n  const eventsWithNestedData = useMemo(\n    () =>\n      events\n        .map(event => ({\n          ...event,\n          type: eventTypes.find(type => type.id === event.type),\n          persons: event.persons\n            ? event.persons.map(personId =>\n                persons.find(person => person.id === personId),\n              )\n            : [],\n          toponyms: event.toponyms\n            ? event.toponyms.map(toponymId =>\n                toponyms.find(toponym => toponym.id === toponymId),\n              )\n            : [],\n        }))\n        .filter(it => it.name.toLowerCase().includes(filter.toLowerCase())),\n    [events, eventTypes, persons, toponyms, filter],\n  );\n\n  const onRow = useCallback(\n    record => ({\n      onClick: onSelect ? () => onSelect(record) : undefined,\n    }),\n    [onSelect],\n  );\n\n  const onSearch = useCallback(\n    debounce(value => setFilter(value)),\n    [],\n  );\n\n  const renderDeleteButton = (_, record) => (\n    <Popconfirm\n      title=\"Вы уверены?\"\n      onConfirm={event => {\n        event.stopPropagation();\n        deleteRow(record);\n      }}\n      onCancel={event => {\n        event.stopPropagation();\n      }}\n      okText=\"Да\"\n      cancelText=\"Нет\"\n    >\n      <Button\n        type=\"link\"\n        onClick={event => {\n          event.stopPropagation();\n        }}\n      >\n        Удалить\n      </Button>\n    </Popconfirm>\n  );\n\n  return (\n    <div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          padding: '10px 20px',\n        }}\n      >\n        <Button type=\"primary\" onClick={onAdd}>\n          Добавить\n        </Button>\n        <Input.Search\n          placeholder=\"Введите значение для поиска\"\n          onSearch={onSearch}\n          style={{ width: 400 }}\n        />\n      </div>\n      <Table\n        dataSource={eventsWithNestedData}\n        rowKey={event => event.id}\n        onRow={onRow}\n      >\n        <Table.Column title=\"Название\" dataIndex=\"name\" width=\"35%\" />\n        <Table.Column\n          title=\"Дата начала\"\n          dataIndex=\"startDate\"\n          width=\"10%\"\n          sorter={startDateSorter}\n          render={dateFormatter}\n        />\n        <Table.Column\n          title=\"Дата окончания\"\n          dataIndex=\"endDate\"\n          width=\"10%\"\n          sorter={endDateSorter}\n          render={dateFormatter}\n        />\n        <Table.Column\n          title=\"Тип\"\n          dataIndex=\"type\"\n          width=\"10%\"\n          filters={eventTypes.map(eventType => ({\n            value: eventType.id,\n            text: eventType.type,\n          }))}\n          onFilter={(value, record) => record.type.id === value}\n          render={typeFormatter}\n        />\n        <Table.Column\n          title=\"Действующие лица\"\n          dataIndex=\"persons\"\n          width=\"15%\"\n          render={personsFormatter}\n        />\n        <Table.Column\n          title=\"Топонимы\"\n          dataIndex=\"toponyms\"\n          width=\"15%\"\n          render={toponymsFormatter}\n        />\n        <Table.Column title=\"\" key=\"delete\" render={renderDeleteButton} />\n      </Table>\n    </div>\n  );\n};\n\nexport default EditorTable;\n","import React from 'react';\nimport { DatePicker } from 'antd';\n\nconst DEFAULT_DATE_FORMAT = 'DD.MM.YYYY';\n\nconst DateBox = ({ dateFormat = DEFAULT_DATE_FORMAT, ...otherProps }) => (\n  <DatePicker format={dateFormat} {...otherProps} />\n);\n\nexport default DateBox;\n","export const ID_FACTORY = it => it.id;\n\nexport const NAME_FACTORY = it => it.name;\n","import React from 'react';\nimport { Select } from 'antd';\nimport { ID_FACTORY, NAME_FACTORY } from './constants';\n\nconst OPTIONS_DEFAULT_VALUE = [];\n\nconst SelectBox = ({\n  options = OPTIONS_DEFAULT_VALUE,\n  optionKeyFactory = ID_FACTORY,\n  optionValueFactory = ID_FACTORY,\n  optionNameFactory = NAME_FACTORY,\n  ...otherProps\n}) => (\n  <Select {...otherProps}>\n    {options.map(option => (\n      <Select.Option\n        key={optionKeyFactory(option)}\n        value={optionValueFactory(option)}\n      >\n        {optionNameFactory(option)}\n      </Select.Option>\n    ))}\n  </Select>\n);\nexport default SelectBox;\n","import React, { useCallback, useMemo, useState } from 'react';\nimport { debounce, uniq } from 'lodash-es';\nimport { Select } from 'antd';\nimport { ID_FACTORY, NAME_FACTORY } from './constants';\n\nconst DEFAULT_VALUE = [];\n\nconst LazySelectSearch = ({\n  allOptions,\n  value = DEFAULT_VALUE,\n  onChange,\n  placeholder,\n  count = 5,\n  optionKeyFactory = ID_FACTORY,\n  optionValueFactory = ID_FACTORY,\n  optionNameFactory = NAME_FACTORY,\n}) => {\n  const [filteredOptions, setFilteredOptions] = useState([]);\n  const onSearch = useCallback(\n    debounce(inputValue => {\n      setFilteredOptions(\n        allOptions.filter(option =>\n          optionNameFactory(option)\n            .toLowerCase()\n            .includes(inputValue.toLocaleLowerCase()),\n        ),\n      );\n    }, 300),\n    [allOptions],\n  );\n\n  const onBlur = useCallback(() => {\n    setFilteredOptions([]);\n  }, []);\n\n  const onChangeHandler = useCallback(\n    newValue => {\n      setFilteredOptions([]);\n      onChange(newValue);\n    },\n    [onChange],\n  );\n\n  const mappedValues = useMemo(\n    () => value.map(v => allOptions.find(p => optionValueFactory(p) === v)),\n    [allOptions, value, optionValueFactory],\n  );\n\n  const options = useMemo(\n    () =>\n      filteredOptions.length\n        ? filteredOptions.slice(0, count)\n        : uniq([...allOptions.slice(0, count), ...mappedValues]),\n    [allOptions, count, filteredOptions, mappedValues],\n  );\n  const hidedOptionsCount = useMemo(\n    () =>\n      filteredOptions.length\n        ? filteredOptions.length - count\n        : allOptions.length - options.length,\n    [allOptions, count, filteredOptions, options.length],\n  );\n\n  return (\n    <Select\n      placeholder={placeholder}\n      mode=\"multiple\"\n      filterOption={false}\n      onSearch={onSearch}\n      onChange={onChangeHandler}\n      onBlur={onBlur}\n      value={value}\n    >\n      {options.map(option => (\n        <Select.Option\n          key={optionKeyFactory(option)}\n          value={optionValueFactory(option)}\n        >\n          {optionNameFactory(option)}\n        </Select.Option>\n      ))}\n      {hidedOptionsCount > 0 && (\n        <Select.Option\n          key=\"__hidedOptionsCount__\"\n          value=\"__hidedOptionsCount__\"\n          disabled\n        >\n          Еще {hidedOptionsCount} вариантов\n        </Select.Option>\n      )}\n    </Select>\n  );\n};\n\nexport default LazySelectSearch;\n","import React, { useCallback, useState } from 'react';\nimport { debounce, identity } from 'lodash-es';\nimport { Field } from 'react-final-form';\nimport { Form, Input } from 'antd';\nimport DateBox from './DateBox';\nimport SelectBox from './SelectBox';\nimport LazySelectSearch from './LazySelectSearch';\n\nconst wrapIntoField = Component => ({\n  name,\n  label,\n  validate,\n  allowNull = true,\n  format = identity,\n  parse = identity,\n  ...otherProps\n}) => (\n  <Field\n    name={name}\n    format={format}\n    parse={parse}\n    allowNull={allowNull}\n    validate={validate}\n  >\n    {({ input: { value, onChange }, meta: { invalid, touched, error } }) => (\n      <Form.Item\n        label={label}\n        validateStatus={touched && invalid ? 'error' : 'success'}\n        help={error}\n      >\n        <Component value={value} onChange={onChange} {...otherProps} />\n      </Form.Item>\n    )}\n  </Field>\n);\n\nconst wrapIntoDebouncedInput = Component =>\n  function DebouncedInput({\n    debounceTimeout = 300,\n    onChange: onChangeFormProps,\n    value,\n    ...otherProps\n  }) {\n    const [viewValue, setViewValue] = useState(value);\n    const onChangeDebounced = useCallback(\n      debounce(updatedValue => {\n        onChangeFormProps(updatedValue);\n      }, debounceTimeout),\n      [],\n    );\n\n    const onChange = useCallback(\n      ({ target: { value: newValue } }) => {\n        setViewValue(newValue);\n        onChangeDebounced(newValue);\n      },\n      [onChangeDebounced],\n    );\n\n    return <Component value={viewValue} onChange={onChange} {...otherProps} />;\n  };\n\nconst WrappedInput = wrapIntoField(wrapIntoDebouncedInput(Input));\n\nconst WrappedTextArea = wrapIntoField(wrapIntoDebouncedInput(Input.TextArea));\n\nconst WrappedDateBox = wrapIntoField(DateBox);\n\nconst WrappedSelectBox = wrapIntoField(SelectBox);\n\nconst WrappedLazySelectSearch = wrapIntoField(LazySelectSearch);\n\nexport {\n  WrappedInput as Input,\n  WrappedTextArea as TextArea,\n  WrappedDateBox as DateBox,\n  WrappedSelectBox as SelectBox,\n  WrappedLazySelectSearch as LazySelectSearch,\n};\n","import { isArray, isNil } from 'lodash-es';\nimport {} from 'moment';\n\nexport const required = value =>\n  isNil(value) || value === '' || (isArray(value) && value.length === 0)\n    ? 'Поле обязательно'\n    : undefined;\n\nexport const dateLessThanOrEqual = (fieldName, fieldLabel) => (\n  value,\n  allValues,\n) =>\n  value.isAfter(allValues[fieldName], 'day')\n    ? `Значение поля должно быть меньше чем ${fieldLabel}`\n    : undefined;\n\nexport const dateMoreThanOrEqual = (fieldName, fieldLabel) => (\n  value,\n  allValues,\n) =>\n  value.isBefore(allValues[fieldName], 'day')\n    ? `Значение поля должно быть больше чем ${fieldLabel}`\n    : undefined;\n\nexport const moreThanOrEqual = (fieldName, fieldLabel) => (value, allValues) =>\n  value < allValues[fieldName]\n    ? `Значение поля должно быть больше чем ${fieldLabel}`\n    : undefined;\n\nexport const lessThanOrEqual = (fieldName, fieldLabel) => (value, allValues) =>\n  value > allValues[fieldName]\n    ? `Значение поля должно быть меньше чем ${fieldLabel}`\n    : undefined;\n\nexport const composeValidators = (...validators) => (value, allValues, meta) =>\n  validators.reduce(\n    (error, validator) => error || validator(value, allValues, meta),\n    undefined,\n  );\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Form as FinalForm } from 'react-final-form';\nimport { useParams } from 'react-router-dom';\nimport { Button, Drawer, Form, Row, Spin } from 'antd';\nimport moment from 'moment';\nimport { DateBox, LazySelectSearch, SelectBox, TextArea } from 'components';\nimport {\n  eventsSelector,\n  eventTypesSelector,\n  personsSelector,\n  toponymsSelector,\n} from 'selectors';\nimport {\n  composeValidators,\n  dateLessThanOrEqual,\n  dateMoreThanOrEqual,\n  required,\n} from './validators';\n\nconst typeNameFactory = it => it.type;\n\nconst patronNameFactory = it => `${it.surname} ${it.name} ${it.patron}`;\n\nconst convertEventToFormFormat = event => ({\n  ...event,\n  startDate: moment(event.startDate),\n  endDate: moment(event.endDate),\n});\n\nconst INITIAL_EVENT_VALUE = {\n  name: null,\n  startDate: null,\n  endDate: null,\n  type: null,\n  toponyms: [],\n  persons: [],\n};\n\nconst EventForm = ({ onSubmit, onClose, title }) => {\n  const eventTypes = useSelector(eventTypesSelector);\n  const toponyms = useSelector(toponymsSelector);\n  const persons = useSelector(personsSelector);\n  const events = useSelector(eventsSelector);\n  const { id: eventId } = useParams();\n\n  if (events.length < 1) {\n    return (\n      <div\n        style={{\n          minHeight: 200,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <Spin size=\"large\" />\n      </div>\n    );\n  }\n\n  const event = events.find(it => it.id === Number(eventId));\n  const initialValues = event\n    ? convertEventToFormFormat(event)\n    : INITIAL_EVENT_VALUE;\n\n  return (\n    <Drawer\n      title={title}\n      onClose={onClose}\n      placement=\"right\"\n      width={450}\n      visible\n      closable\n      destroyOnClose\n    >\n      <FinalForm\n        initialValues={initialValues}\n        onSubmit={values => {\n          onSubmit(values);\n        }}\n      >\n        {({ handleSubmit }) => (\n          <Form layout=\"vertical\" onSubmit={handleSubmit}>\n            <Row>\n              <TextArea\n                name=\"name\"\n                label=\"Название\"\n                rows={4}\n                placeholder=\"Название\"\n                validate={required}\n              />\n            </Row>\n            <Row>\n              <DateBox\n                name=\"startDate\"\n                label=\"Дата начала\"\n                validate={composeValidators(\n                  required,\n                  dateLessThanOrEqual('endDate', 'Дата окончания'),\n                )}\n              />\n            </Row>\n            <Row>\n              <DateBox\n                name=\"endDate\"\n                label=\"Дата окончания\"\n                validate={composeValidators(\n                  required,\n                  dateMoreThanOrEqual('startDate', 'Дата начала'),\n                )}\n              />\n            </Row>\n            <Row>\n              <SelectBox\n                name=\"type\"\n                label=\"Тип\"\n                options={eventTypes}\n                optionNameFactory={typeNameFactory}\n                validate={required}\n              />\n            </Row>\n            <Row>\n              <LazySelectSearch\n                name=\"toponyms\"\n                label=\"Топонимы\"\n                allOptions={toponyms}\n                placeholder=\"Выберите топонимы\"\n              />\n            </Row>\n            <Row>\n              <LazySelectSearch\n                name=\"persons\"\n                label=\"Действующие лица\"\n                allOptions={persons}\n                optionNameFactory={patronNameFactory}\n                placeholder=\"Выберите действующих лиц\"\n              />\n            </Row>\n            <div\n              style={{\n                position: 'absolute',\n                right: 0,\n                bottom: 0,\n                width: '100%',\n                borderTop: '1px solid #e9e9e9',\n                padding: '10px 16px',\n                background: '#fff',\n                textAlign: 'right',\n              }}\n            >\n              <Button htmlType=\"submit\" type=\"primary\">\n                Сохранить\n              </Button>\n            </div>\n          </Form>\n        )}\n      </FinalForm>\n    </Drawer>\n  );\n};\n\nexport default EventForm;\n","import { editorDataPage } from 'App/routes';\n\nexport const addRoute = `${editorDataPage}/add`;\n\nexport const editRoute = `${editorDataPage}/edit/:id`;\n","export const viewDataPage = '/view';\nexport const editorDataPage = '/editor';\n","import React, { useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { generatePath, Route, useHistory } from 'react-router-dom';\nimport { Layout, PageHeader } from 'antd';\nimport { uniqueId } from 'lodash-es';\nimport { addEvent, deleteEvent, editEvent } from 'ducks';\nimport { editorDataPage } from 'App/routes';\nimport DownloadButton from './DownloadButton';\nimport EditorTable from './EditorTable';\nimport EventForm from './EventForm';\nimport { addRoute, editRoute } from './routes';\n\nconst DataEditorPage = () => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const onSelect = useCallback(\n    value => {\n      history.push(generatePath(editRoute, { id: value.id }));\n    },\n    [history],\n  );\n\n  const closeForm = useCallback(() => {\n    history.push(editorDataPage);\n  }, [history]);\n\n  const changeEvent = useCallback(\n    value => {\n      dispatch(\n        editEvent({\n          ...value,\n          endDate: value.endDate.toDate(),\n          startDate: value.startDate.toDate(),\n        }),\n      );\n      closeForm();\n    },\n    [dispatch, closeForm],\n  );\n\n  const onDelete = useCallback(\n    value => {\n      dispatch(deleteEvent(value));\n    },\n    [dispatch],\n  );\n\n  const createEvent = useCallback(\n    value => {\n      dispatch(\n        addEvent({\n          ...value,\n          id: uniqueId(),\n          endDate: value.endDate.toDate(),\n          startDate: value.startDate.toDate(),\n        }),\n      );\n      closeForm();\n    },\n    [closeForm, dispatch],\n  );\n\n  const showAddForm = useCallback(() => {\n    history.push(addRoute);\n  }, [history]);\n\n  return (\n    <Layout>\n      <PageHeader\n        ghost={false}\n        title=\"Редактирование данных\"\n        extra={<DownloadButton />}\n      />\n      <Layout.Content>\n        <EditorTable\n          onAdd={showAddForm}\n          onSelect={onSelect}\n          deleteRow={onDelete}\n        />\n        <Route\n          path={addRoute}\n          render={() => (\n            <EventForm\n              onClose={closeForm}\n              onSubmit={createEvent}\n              title=\"Добавление события\"\n            />\n          )}\n        />\n        <Route\n          path={editRoute}\n          render={() => (\n            <EventForm\n              onClose={closeForm}\n              onSubmit={changeEvent}\n              title=\"Редактирование события\"\n            />\n          )}\n        />\n      </Layout.Content>\n    </Layout>\n  );\n};\n\nexport default DataEditorPage;\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { Link, Redirect, Route, Switch, useLocation } from 'react-router-dom';\nimport { Icon, Layout, Menu } from 'antd';\nimport { loadEvents } from '../ducks';\nimport DataViewPage from './DataViewPage';\nimport DataEditorPage from './DataEditorPage';\nimport { editorDataPage, viewDataPage } from './routes';\n\nconst ROUTES = [viewDataPage, editorDataPage];\n\nconst FULL_SIDER_WIDTH = 240;\n\nconst App = () => {\n  const [collapsed, setCollapsed] = useState(true);\n  const dispatch = useDispatch();\n  const { pathname } = useLocation();\n\n  const selectedMenuKeys = useMemo(\n    () => [ROUTES.find(route => route === pathname)],\n    [pathname],\n  );\n\n  useEffect(() => {\n    dispatch(loadEvents());\n  }, [dispatch]);\n\n  return (\n    <Layout style={{ minHeight: '100vh' }} hasSider>\n      <Layout.Sider\n        theme=\"dark\"\n        collapsible\n        width={FULL_SIDER_WIDTH}\n        collapsed={collapsed}\n        onCollapse={setCollapsed}\n        style={{\n          overflow: 'auto',\n          height: '100vh',\n          position: 'fixed',\n          left: 0,\n        }}\n      >\n        <Menu theme=\"dark\" mode=\"inline\" selectedKeys={selectedMenuKeys}>\n          <Menu.Item key={viewDataPage}>\n            <Link to={viewDataPage}>\n              <Icon type=\"pie-chart\" />\n              <span>Просмотр данных</span>\n            </Link>\n          </Menu.Item>\n          <Menu.Item key={editorDataPage}>\n            <Link to={editorDataPage}>\n              <Icon type=\"edit\" />\n              <span>Редактирование данных</span>\n            </Link>\n          </Menu.Item>\n        </Menu>\n      </Layout.Sider>\n      <Layout\n        style={{\n          marginLeft: collapsed ? 80 : FULL_SIDER_WIDTH,\n          transition: 'margin 0.2s',\n        }}\n      >\n        <Layout.Content>\n          <Switch>\n            <Route path={viewDataPage} component={DataViewPage} />\n            <Route path={editorDataPage} component={DataEditorPage} />\n            <Redirect to={viewDataPage} />\n          </Switch>\n        </Layout.Content>\n      </Layout>\n    </Layout>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { HashRouter as Router } from 'react-router-dom';\nimport store from './store';\nimport App from './App/App';\nimport './index.css';\n\nconst renderApp = () => (\n  <Router>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </Router>\n);\n\nReactDOM.render(renderApp(), document.getElementById('root'));\n"],"sourceRoot":""}